# 4번 문제

주어진 프로젝트는 다음의 기능을 구현하고자 생성한 프로젝트이다.

### 1. Player
- 상태 패턴을 사용해 Idle 상태와 Attack 상태를 관리한다.
- Idle상태에서 Q를 누르면 Attack 상태로 진입한다
  - 진입 시 2초 이후 지정된 구형 범위 내에 있는 데미지를 입을 수 있는 적을 탐색해 데미지를 부여하고 Idle상태로 돌아온다
- 상태 머신 : 각 상태들을 관리하는 객체이며, 가장 첫번째로 입력받은 상태를 기본 상태로 설정한다.

### 2. NormalMonster
- 데미지를 입을 수 있는 몬스터

### 3. ShieldeMonster
- 데미지를 입지 않는 몬스터

위 기능들을 구현하고자 할 때
제시된 프로젝트에서 발생하는 `문제들을 모두 서술`하고 올바르게 동작하도록 `소스코드를 개선`하시오.

## 답안
- 공격이 끝난 이후, AttackState스크립트에서 null 참조 오류가 떴다.
  > 진행중이던 코루틴에서 공격 대상을 한번 더 찾았으나 공격 대상이 없어서 null오류가 났다고 판단했다.    
  > 따라서 Attack()안의 foreach문에 if (damagable == null) return; 코드를 넣어서 해결했다.    

- null참조 오류는 해결됐으나, 스택 오버플로우가 발생했다.  
  > Exit()에서 ChangeState()를 호출해서 ChangeState()도 Exit()를 호출했기 때문에 발생한 오류이다.       
  위의 if문 안으로 ChangeState()를 옮겨주었다.    

- 문제가 발생하지 않도록 코루틴 변수를 만들어서 Exit()에서 StopCoroutine(코루틴변수); 해주었다.
  > 공격이 끝난 뒤, IDamageable을 가진 객체를 모두 없애고 나면 정상적으로 Idle상태로 전환되었다.
  
